metadata:
  name: "Ensure resources have required tags (CoreCloud and Test)"
  id: "CKV_CCL_CUSTOM_002"
  category: "CONVENTION"
  guideline: "All resources must have 'CoreCloud' and 'Test' tags"
definition:
  cond_type: "attribute"
  resource_types:
    - "aws_instance"
    - "aws_s3_bucket"
    - "aws_db_instance"
    - "aws_vpc"
    - "aws_subnet"
    - "aws_security_group"
    - "aws_lambda_function"
    - "aws_ecs_cluster"
    - "aws_eks_cluster"
  attribute: "tags"
  operator: "and"
  conditions:
    - operator: "exists"
      key: "CoreCloud"
    - operator: "exists"
      key: "Test"
