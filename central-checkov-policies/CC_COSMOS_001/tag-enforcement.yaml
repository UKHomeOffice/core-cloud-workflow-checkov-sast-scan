metadata:
  name: "Ensure resources have required tag associated for Costing"
  id: "CC_COSMOS_001"
  category: "FINOPS"
  guideline: "All listed resources must have the mandatory tags as specified: https://collaboration.homeoffice.gov.uk/display/CORE/Core+Cloud+Tags"
definition:
  and:
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.cost-centre"
    operator: "equals"
    value: "1709144"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.account-code"
    operator: "equals"
    value: "521835"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.portfolio-id"
    operator: "equals"
    value: "cto"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.project-id"
    operator: "equals"
    value: "corecloud"
  - cond_type: "attribute"
    resource_types: "taggable"
    attribute: "tags.service-id"
    operator: "exists"